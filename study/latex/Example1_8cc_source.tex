\hypertarget{Example1_8cc_source}{}\doxysection{Example1.\+cc}
\label{Example1_8cc_source}\index{tests/Example1.cc@{tests/Example1.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{// Example1.cpp}}
\DoxyCodeLine{00002 \textcolor{comment}{//}}
\DoxyCodeLine{00003 \textcolor{comment}{// Showing usage of RTTI. In order for}}
\DoxyCodeLine{00004 \textcolor{comment}{// it to work, RTTI must encounter at least one}}
\DoxyCodeLine{00005 \textcolor{comment}{// virtual function in class hierarchy.}}
\DoxyCodeLine{00006 \textcolor{comment}{//}}
\DoxyCodeLine{00007 \textcolor{comment}{// AND AND DO NOT FORGET TO ENABLE RTTI IN THE PROJECT SETTINGS }}
\DoxyCodeLine{00008 \textcolor{comment}{// /GR, FOR EXAMPLE!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{00009 \textcolor{comment}{//}}
\DoxyCodeLine{00010 \textcolor{comment}{// You can use this as a prototype example for your own classes.}}
\DoxyCodeLine{00011 \textcolor{comment}{//}}
\DoxyCodeLine{00012 \textcolor{comment}{// (C) Datasim Education BV 2005-\/2006}}
\DoxyCodeLine{00013 \textcolor{comment}{//}}
\DoxyCodeLine{00014 }
\DoxyCodeLine{00015 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{00016 \textcolor{preprocessor}{\#include <typeinfo>}     \textcolor{comment}{// RTTI stuff here}}
\DoxyCodeLine{00017 }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00018}\mbox{\hyperlink{classBase}{00018}} \textcolor{keyword}{class }\mbox{\hyperlink{classBase}{Base}}}
\DoxyCodeLine{00019 \{}
\DoxyCodeLine{00020 }
\DoxyCodeLine{00021 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00022}\mbox{\hyperlink{classBase_a5ffe0568374d8b9b4c4ec32953fd6453}{00022}}     \mbox{\hyperlink{classBase_a5ffe0568374d8b9b4c4ec32953fd6453}{Base}}() \{\} }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00023}\mbox{\hyperlink{classBase_a9c3e236ef414e648e48e250a3e43a880}{00023}}     \textcolor{keyword}{virtual} \mbox{\hyperlink{classBase_a9c3e236ef414e648e48e250a3e43a880}{~Base}}() \{\}}
\DoxyCodeLine{00024 }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00025}\mbox{\hyperlink{classBase_af73d9cfca012bd07d3ed7c47787c0b26}{00025}}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classBase_af73d9cfca012bd07d3ed7c47787c0b26}{print}}()\textcolor{keyword}{ const }\{ std::cout << \textcolor{stringliteral}{"I'm base\(\backslash\)n"}; \}}
\DoxyCodeLine{00026     \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classBase_a8b862f41b7eb65afde267566b918f5ed}{calculate}}(\textcolor{keywordtype}{double} d) \textcolor{keyword}{const} = 0;}
\DoxyCodeLine{00027     }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00028}\mbox{\hyperlink{classBase_a872a7491ff0d4c9195ef033abc3ce80c}{00028}}     \textcolor{keywordtype}{void} \mbox{\hyperlink{classBase_a872a7491ff0d4c9195ef033abc3ce80c}{doIt}}() \{ std::cout << \textcolor{stringliteral}{"in base\(\backslash\)n"}; \}}
\DoxyCodeLine{00029 }
\DoxyCodeLine{00030 \};}
\DoxyCodeLine{00031 }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00032}\mbox{\hyperlink{classD1}{00032}} \textcolor{keyword}{class }\mbox{\hyperlink{classD1}{D1}}: \textcolor{keyword}{public} \mbox{\hyperlink{classBase}{Base}}}
\DoxyCodeLine{00033 \{}
\DoxyCodeLine{00034 }
\DoxyCodeLine{00035 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00036}\mbox{\hyperlink{classD1_aca41ff948be5ec0f1533b565cc2af85a}{00036}}     \mbox{\hyperlink{classD1_aca41ff948be5ec0f1533b565cc2af85a}{D1}}() \{\} }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00037}\mbox{\hyperlink{classD1_ac9f5ce0e0b5c287caab8cdaace9d4fb2}{00037}}     \textcolor{keyword}{virtual} \mbox{\hyperlink{classD1_ac9f5ce0e0b5c287caab8cdaace9d4fb2}{~D1}}() \{\}}
\DoxyCodeLine{00038 }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00039}\mbox{\hyperlink{classD1_a935c675cf9248eeb13f0095353d1399c}{00039}}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classD1_a935c675cf9248eeb13f0095353d1399c}{print}}()\textcolor{keyword}{ const }\{ std::cout << \textcolor{stringliteral}{"I'm a D1\(\backslash\)n"}; \}}
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00040}\mbox{\hyperlink{classD1_a0350c2a76a1a19ba1e5b52e211a3415b}{00040}}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classD1_a0350c2a76a1a19ba1e5b52e211a3415b}{calculate}}(\textcolor{keywordtype}{double} d)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 1.0 * d; \}}
\DoxyCodeLine{00041 }
\DoxyCodeLine{00042 \};}
\DoxyCodeLine{00043 }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00044}\mbox{\hyperlink{classD2}{00044}} \textcolor{keyword}{class }\mbox{\hyperlink{classD2}{D2}}: \textcolor{keyword}{public} \mbox{\hyperlink{classBase}{Base}}}
\DoxyCodeLine{00045 \{}
\DoxyCodeLine{00046 }
\DoxyCodeLine{00047 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00048}\mbox{\hyperlink{classD2_a4902a6f316ef4f6f66bc49f2c015a271}{00048}}     \mbox{\hyperlink{classD2_a4902a6f316ef4f6f66bc49f2c015a271}{D2}}() \{\} }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00049}\mbox{\hyperlink{classD2_ab3502fff784918aee4f87b0c17ade3b6}{00049}}     \textcolor{keyword}{virtual} \mbox{\hyperlink{classD2_ab3502fff784918aee4f87b0c17ade3b6}{~D2}}() \{\}}
\DoxyCodeLine{00050 }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00051}\mbox{\hyperlink{classD2_a3616a7e04ee7b3fa3b40c87583a20e13}{00051}}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classD2_a3616a7e04ee7b3fa3b40c87583a20e13}{print}}()\textcolor{keyword}{ const }\{ std::cout << \textcolor{stringliteral}{"I'm a D2\(\backslash\)n"}; \}}
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00052}\mbox{\hyperlink{classD2_a460cd9888067098586fbc07ac7385c9e}{00052}}     \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classD2_a460cd9888067098586fbc07ac7385c9e}{calculate}}(\textcolor{keywordtype}{double} d)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 2.0 * d; \}}
\DoxyCodeLine{00053 }
\DoxyCodeLine{00054 \};}
\DoxyCodeLine{00055 }
\DoxyCodeLine{00056 }
\DoxyCodeLine{\Hypertarget{Example1_8cc_source_l00057}\mbox{\hyperlink{Example1_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{00057}} \textcolor{keywordtype}{int} \mbox{\hyperlink{Example1_8cc_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}()}
\DoxyCodeLine{00058 \{}
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060     \textcolor{comment}{// Part I: typeinfo}}
\DoxyCodeLine{00061 }
\DoxyCodeLine{00062     \mbox{\hyperlink{classD1}{D1}} d1, d11;}
\DoxyCodeLine{00063     \mbox{\hyperlink{classD2}{D2}} d2;}
\DoxyCodeLine{00064 }
\DoxyCodeLine{00065     \textcolor{comment}{// Define a reference to type}}
\DoxyCodeLine{00066     \textcolor{keyword}{const} std::type\_info\& myRef = \textcolor{keyword}{typeid}(d1);}
\DoxyCodeLine{00067     }
\DoxyCodeLine{00068     std::cout << \textcolor{stringliteral}{"Human-\/readable name: "} << myRef.name() << std::endl;}
\DoxyCodeLine{00069 }
\DoxyCodeLine{00070     \textcolor{comment}{// Test if two objects have same type or not}}
\DoxyCodeLine{00071     \textcolor{keywordflow}{if} (\textcolor{keyword}{typeid}(d1) == \textcolor{keyword}{typeid}(d11))}
\DoxyCodeLine{00072     \{}
\DoxyCodeLine{00073         std::cout << \textcolor{stringliteral}{"Types are the same\(\backslash\)n"};}
\DoxyCodeLine{00074     \}}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076     \textcolor{keywordflow}{if} (\textcolor{keyword}{typeid}(d1) != \textcolor{keyword}{typeid}(d2))}
\DoxyCodeLine{00077     \{}
\DoxyCodeLine{00078         std::cout << \textcolor{stringliteral}{"Types are NOT the same\(\backslash\)n"};}
\DoxyCodeLine{00079     \}}
\DoxyCodeLine{00080 }
\DoxyCodeLine{00081 }
\DoxyCodeLine{00082     \mbox{\hyperlink{classBase}{Base}}* \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}} = \&d1;}
\DoxyCodeLine{00083     \textcolor{keyword}{const} std::type\_info\& myRef2 = \textcolor{keyword}{typeid}(*b);}
\DoxyCodeLine{00084 }
\DoxyCodeLine{00085     std::cout << \textcolor{stringliteral}{"Human-\/readable name: "} << myRef2.name() << std::endl;}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087 }
\DoxyCodeLine{00088     \textcolor{comment}{// Create an array of Base class pointers}}
\DoxyCodeLine{00089     \textcolor{keywordtype}{int} size = 10;}
\DoxyCodeLine{00090     \mbox{\hyperlink{classBase}{Base}}* myArr[10];    \textcolor{comment}{// An array of pointers!}}
\DoxyCodeLine{00091 }
\DoxyCodeLine{00092     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 6; j++)}
\DoxyCodeLine{00093     \{}
\DoxyCodeLine{00094         myArr[j] = \&d1;}
\DoxyCodeLine{00095     \}}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 6; k < size; k++)}
\DoxyCodeLine{00098     \{}
\DoxyCodeLine{00099         myArr[k] = \&d2;}
\DoxyCodeLine{00100     \}}
\DoxyCodeLine{00101 }
\DoxyCodeLine{00102     \textcolor{comment}{// Now 'filter' the real types. We have D1 and D2 types!}}
\DoxyCodeLine{00103     \textcolor{keywordtype}{int} counterD1 = 0;}
\DoxyCodeLine{00104     \textcolor{keywordtype}{int} counterD2 = 0;}
\DoxyCodeLine{00105 }
\DoxyCodeLine{00106     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < size; i++)}
\DoxyCodeLine{00107     \{}
\DoxyCodeLine{00108         \textcolor{keywordflow}{if} (\textcolor{keyword}{typeid}(*myArr[i]) == \textcolor{keyword}{typeid}(\mbox{\hyperlink{classD1}{D1}}))}
\DoxyCodeLine{00109         \{}
\DoxyCodeLine{00110             std::cout << \textcolor{stringliteral}{"We have a D1\(\backslash\)n"}; counterD1++;}
\DoxyCodeLine{00111         \}}
\DoxyCodeLine{00112 }
\DoxyCodeLine{00113         \textcolor{keywordflow}{if} (\textcolor{keyword}{typeid}(*myArr[i]) == \textcolor{keyword}{typeid}(\mbox{\hyperlink{classD2}{D2}}))}
\DoxyCodeLine{00114         \{}
\DoxyCodeLine{00115             std::cout << \textcolor{stringliteral}{"We have a D2\(\backslash\)n"}; counterD2++;}
\DoxyCodeLine{00116         \}}
\DoxyCodeLine{00117 }
\DoxyCodeLine{00118     \}}
\DoxyCodeLine{00119 }
\DoxyCodeLine{00120     \textcolor{comment}{// Print final counts}}
\DoxyCodeLine{00121     std::cout << \textcolor{stringliteral}{"Number of D1s: "} << counterD1 << std::endl;}
\DoxyCodeLine{00122     std::cout << \textcolor{stringliteral}{"Number of D2s: "} << counterD2 << std::endl;}
\DoxyCodeLine{00123 }
\DoxyCodeLine{00124     \textcolor{comment}{// Part II: dynamic casting}}
\DoxyCodeLine{00125 }
\DoxyCodeLine{00126     \mbox{\hyperlink{classD1}{D1}} d1A;}
\DoxyCodeLine{00127     \mbox{\hyperlink{classBase}{Base}}* base2 = \&d1A;}
\DoxyCodeLine{00128 }
\DoxyCodeLine{00129     \mbox{\hyperlink{classD1}{D1}}* d1Cast = dynamic\_cast<D1*> (base2);}
\DoxyCodeLine{00130 }
\DoxyCodeLine{00131     \textcolor{keywordflow}{if} (d1Cast == 0)}
\DoxyCodeLine{00132     \{}
\DoxyCodeLine{00133         std::cout << \textcolor{stringliteral}{"Cast not possible:\(\backslash\)n"};}
\DoxyCodeLine{00134     \}}
\DoxyCodeLine{00135     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00136     \{ \textcolor{comment}{// This function gets called}}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138         std::cout << \textcolor{stringliteral}{"Cast is possible: "};}
\DoxyCodeLine{00139         d1Cast -\/> \mbox{\hyperlink{ArrayMechanisms_8hh_a7a738d11c1fc7a5a9204c8c2adb08402}{print}}();}
\DoxyCodeLine{00140     \}}
\DoxyCodeLine{00141 }
\DoxyCodeLine{00142     \textcolor{comment}{// Now cast a D1 to a D2 (not possible)}}
\DoxyCodeLine{00143     \mbox{\hyperlink{classD2}{D2}}* d2Cast = dynamic\_cast<D2*> (base2);}
\DoxyCodeLine{00144 }
\DoxyCodeLine{00145     \textcolor{keywordflow}{if} (d2Cast == 0)}
\DoxyCodeLine{00146     \{ \textcolor{comment}{// This function gets called}}
\DoxyCodeLine{00147 }
\DoxyCodeLine{00148         std::cout << \textcolor{stringliteral}{"Cast not possible:\(\backslash\)n"};}
\DoxyCodeLine{00149     \}}
\DoxyCodeLine{00150     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00151     \{}
\DoxyCodeLine{00152         std::cout << \textcolor{stringliteral}{"Cast is possible:\(\backslash\)n"};}
\DoxyCodeLine{00153         d2Cast -\/> \mbox{\hyperlink{ArrayMechanisms_8hh_a7a738d11c1fc7a5a9204c8c2adb08402}{print}}();}
\DoxyCodeLine{00154     \}}
\DoxyCodeLine{00155 }
\DoxyCodeLine{00156     \textcolor{comment}{// Upcasting}}
\DoxyCodeLine{00157     \mbox{\hyperlink{classD1}{D1}}* dd = \textcolor{keyword}{new} \mbox{\hyperlink{classD1}{D1}};}
\DoxyCodeLine{00158     \mbox{\hyperlink{classBase}{Base}}* b3 = dynamic\_cast<Base*> (dd);}
\DoxyCodeLine{00159 }
\DoxyCodeLine{00160     \textcolor{keywordflow}{if} (b3 == 0)}
\DoxyCodeLine{00161     \{ \textcolor{comment}{// This function gets called}}
\DoxyCodeLine{00162 }
\DoxyCodeLine{00163         std::cout << \textcolor{stringliteral}{"Cast not possible:\(\backslash\)n"};}
\DoxyCodeLine{00164     \}}
\DoxyCodeLine{00165     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00166     \{}
\DoxyCodeLine{00167         std::cout << \textcolor{stringliteral}{"Cast is possible:\(\backslash\)n"};}
\DoxyCodeLine{00168         b3 -\/> \mbox{\hyperlink{ArrayMechanisms_8hh_a7a738d11c1fc7a5a9204c8c2adb08402}{print}}();}
\DoxyCodeLine{00169         b3 -\/> doIt();}
\DoxyCodeLine{00170     \}}
\DoxyCodeLine{00171     \textcolor{keyword}{delete} dd;}
\DoxyCodeLine{00172 }
\DoxyCodeLine{00173     \textcolor{comment}{// Static casting}}
\DoxyCodeLine{00174     \mbox{\hyperlink{classBase}{Base}}* bA = \&d1;}
\DoxyCodeLine{00175     \mbox{\hyperlink{classBase}{Base}}* bB = \&d2;}
\DoxyCodeLine{00176 }
\DoxyCodeLine{00177     \mbox{\hyperlink{classD1}{D1}}* dA = static\_cast<D1*> (bA);}
\DoxyCodeLine{00178 }
\DoxyCodeLine{00179     \textcolor{comment}{// Unsafe static cast}}
\DoxyCodeLine{00180     std::cout << \textcolor{stringliteral}{"Unsafe cast ...\(\backslash\)n"};}
\DoxyCodeLine{00181     \mbox{\hyperlink{classD1}{D1}}* dB = static\_cast<D1*> (bB);}
\DoxyCodeLine{00182     dB -\/> \mbox{\hyperlink{ArrayMechanisms_8hh_a7a738d11c1fc7a5a9204c8c2adb08402}{print}}();}
\DoxyCodeLine{00183 }
\DoxyCodeLine{00184     \textcolor{comment}{// Const Cast}}
\DoxyCodeLine{00185     std::cout << \textcolor{stringliteral}{"\(\backslash\)n const cast stuff\(\backslash\)n"};}
\DoxyCodeLine{00186     \mbox{\hyperlink{classD1}{D1}} dAny;}
\DoxyCodeLine{00187     \textcolor{keyword}{const} \mbox{\hyperlink{classBase}{Base}}* bConst = \&dAny;}
\DoxyCodeLine{00188     bConst -\/> \mbox{\hyperlink{ArrayMechanisms_8hh_a7a738d11c1fc7a5a9204c8c2adb08402}{print}}();}
\DoxyCodeLine{00189     \textcolor{comment}{// Base* bNonConst = bConst; DOES NOT WORK}}
\DoxyCodeLine{00190     \mbox{\hyperlink{classBase}{Base}}* bNonConst = const\_cast<Base*> (bConst);}
\DoxyCodeLine{00191     bNonConst -\/> \mbox{\hyperlink{ArrayMechanisms_8hh_a7a738d11c1fc7a5a9204c8c2adb08402}{print}}();}
\DoxyCodeLine{00192 }
\DoxyCodeLine{00193     \textcolor{comment}{// The following conversions do not work}}
\DoxyCodeLine{00194 \textcolor{comment}{//  Base* bNonConst1 = static\_cast<Base*> (bConst);}}
\DoxyCodeLine{00195 \textcolor{comment}{//  Base* bNonConst2 = dynamic\_cast<Base*> (bConst);}}
\DoxyCodeLine{00196 \textcolor{comment}{//  Base* bNonConst3 = reinterpret\_cast<Base*> (bConst);}}
\DoxyCodeLine{00197 }
\DoxyCodeLine{00198     \textcolor{comment}{// Reinterpret Cast}}
\DoxyCodeLine{00199     std::cout << \textcolor{stringliteral}{"\(\backslash\)nReinterpret cast stuff\(\backslash\)n"};}
\DoxyCodeLine{00200 }
\DoxyCodeLine{00201     \mbox{\hyperlink{classD2}{D2}} d2Any;}
\DoxyCodeLine{00202     \mbox{\hyperlink{classBase}{Base}}* bb = reinterpret\_cast<Base*>(\&d2Any);}
\DoxyCodeLine{00203     bb -\/> \mbox{\hyperlink{ArrayMechanisms_8hh_a7a738d11c1fc7a5a9204c8c2adb08402}{print}}();}
\DoxyCodeLine{00204 }
\DoxyCodeLine{00205     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00206 \}}

\end{DoxyCode}
