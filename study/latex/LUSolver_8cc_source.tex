\hypertarget{LUSolver_8cc_source}{}\doxysection{L\+U\+Solver.\+cc}
\label{LUSolver_8cc_source}\index{src/LUSolver.cc@{src/LUSolver.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{// matrixsolvermechanisms.cpp}}
\DoxyCodeLine{00002 \textcolor{comment}{//}}
\DoxyCodeLine{00003 \textcolor{comment}{// Classes and functions for solving linear systems of equations }}
\DoxyCodeLine{00004 \textcolor{comment}{// (numerical linear algebra).}}
\DoxyCodeLine{00005 \textcolor{comment}{//}}
\DoxyCodeLine{00006 \textcolor{comment}{// Modification Dates:}}
\DoxyCodeLine{00007 \textcolor{comment}{//}}
\DoxyCodeLine{00008 \textcolor{comment}{//  DD 2003-\/1-\/14 First code (tridiagonal)}}
\DoxyCodeLine{00009 \textcolor{comment}{//  DD 2003-\/1-\/16 DD small corrections: still to code 2 member functions}}
\DoxyCodeLine{00010 \textcolor{comment}{//  DD 2003-\/8-\/2 LU decomposition of tridiagonal systems; 2 functions}}
\DoxyCodeLine{00011 \textcolor{comment}{//  (Boolean checks added)}}
\DoxyCodeLine{00012 \textcolor{comment}{//  DD 2003-\/8-\/5 Matrix iterative solvers (Jacobi, Gauss Seidel)}}
\DoxyCodeLine{00013 \textcolor{comment}{//  DD 2003-\/8-\/21 Debugging and good testing}}
\DoxyCodeLine{00014 \textcolor{comment}{//  DD 2003-\/9-\/1 Debugging Jacobi}}
\DoxyCodeLine{00015 \textcolor{comment}{//  DD 2004-\/4-\/10 New implementation using the Template Method pattern}}
\DoxyCodeLine{00016 \textcolor{comment}{//  DD 2004-\/4-\/11 Implement PSOR as a derived class. Lots of reuse}}
\DoxyCodeLine{00017 \textcolor{comment}{//  DD 2005-\/10-\/6 LU version for C++ Intro book. Optimised, no copy of arrays}}
\DoxyCodeLine{00018 \textcolor{comment}{//  DD 2005-\/10-\/15 Function to test diagonal dominance}}
\DoxyCodeLine{00019 \textcolor{comment}{//  DD 2006-\/1-\/10 Clean up cout stuff}}
\DoxyCodeLine{00020 \textcolor{comment}{//}}
\DoxyCodeLine{00021 \textcolor{comment}{// (C) Datasim Education BV 2003-\/2006}}
\DoxyCodeLine{00022 }
\DoxyCodeLine{00023 \textcolor{preprocessor}{\#ifndef LUSolver\_CC}}
\DoxyCodeLine{\Hypertarget{LUSolver_8cc_source_l00024}\mbox{\hyperlink{LUSolver_8cc_adcca6a11e885ff211895b7af308967c7}{00024}} \textcolor{preprocessor}{\#define LUSolver\_CC}}
\DoxyCodeLine{00025 }
\DoxyCodeLine{00026 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{LUSolver_8hh}{duffy/LUSolver.hh}}>}}
\DoxyCodeLine{00027 }
\DoxyCodeLine{00028 \textcolor{keyword}{template} <\textcolor{keyword}{class} V, \textcolor{keyword}{class} I> \textcolor{keywordtype}{void} \mbox{\hyperlink{classLUTridiagonalSolver}{LUTridiagonalSolver<V,I>::calculateBetaGamma}}()}
\DoxyCodeLine{00029 \{ \textcolor{comment}{// Calculate beta and gamma}}
\DoxyCodeLine{00030 }
\DoxyCodeLine{00031     \textcolor{comment}{// Size == J}}
\DoxyCodeLine{00032 }
\DoxyCodeLine{00033     \textcolor{comment}{// Constructor derived from Array (size, startIndex [,value])}}
\DoxyCodeLine{00034     beta = \mbox{\hyperlink{classVector}{Vector<V,I>}} (Size, 1);}
\DoxyCodeLine{00035     gamma = \mbox{\hyperlink{classVector}{Vector<V,I>}} (Size -\/ 1, 1);}
\DoxyCodeLine{00036 }
\DoxyCodeLine{00037     beta[1] = \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}}[1];}
\DoxyCodeLine{00038     gamma[1] = c[1] / beta[1];}
\DoxyCodeLine{00039 }
\DoxyCodeLine{00040     \textcolor{keywordflow}{for} (I j = 2; j <= Size-\/1; j++)}
\DoxyCodeLine{00041     \{}
\DoxyCodeLine{00042         beta[j] = \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}}[j] -\/ (a[j] * gamma[j-\/1]);}
\DoxyCodeLine{00043         gamma[j] = c[j]/beta[j];}
\DoxyCodeLine{00044 }
\DoxyCodeLine{00045     \}}
\DoxyCodeLine{00046     }
\DoxyCodeLine{00047     beta[Size] = \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}}[Size] -\/ (a[Size] * gamma[Size-\/1]);}
\DoxyCodeLine{00048 }
\DoxyCodeLine{00049 \}}
\DoxyCodeLine{00050 }
\DoxyCodeLine{00051 \textcolor{keyword}{template} <\textcolor{keyword}{class} V, \textcolor{keyword}{class} I> \textcolor{keywordtype}{void} \mbox{\hyperlink{classLUTridiagonalSolver}{LUTridiagonalSolver<V,I>::calculateZU}}()}
\DoxyCodeLine{00052 \{ \textcolor{comment}{// Calculate z and u}}
\DoxyCodeLine{00053 }
\DoxyCodeLine{00054     z = \mbox{\hyperlink{classVector}{Vector<V,I>}} (Size, 1);}
\DoxyCodeLine{00055     u = \mbox{\hyperlink{classVector}{Vector<V,I>}} (Size, 1);}
\DoxyCodeLine{00056 }
\DoxyCodeLine{00057     \textcolor{comment}{// Forward direction}}
\DoxyCodeLine{00058     z[1] = \mbox{\hyperlink{namespaceNSEuropeanOption_adf476278b7e6a6960d82dc00e93ef723}{r}}[1] / beta[1];}
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060     \textcolor{keywordflow}{for} (I j = 2; j <= Size; j++)}
\DoxyCodeLine{00061     \{}
\DoxyCodeLine{00062         z[j] = (\mbox{\hyperlink{namespaceNSEuropeanOption_adf476278b7e6a6960d82dc00e93ef723}{r}}[j] -\/ (a[j]*z[j-\/1]) ) / beta[j];}
\DoxyCodeLine{00063     }
\DoxyCodeLine{00064     \}}
\DoxyCodeLine{00065 }
\DoxyCodeLine{00066     \textcolor{comment}{// Backward direction}}
\DoxyCodeLine{00067     u[Size] = z[Size];}
\DoxyCodeLine{00068 }
\DoxyCodeLine{00069     \textcolor{keywordflow}{for} (I i = Size -\/ 1; i >= 1; i-\/-\/)}
\DoxyCodeLine{00070     \{}
\DoxyCodeLine{00071         u[i] = z[i] -\/ (gamma[i]*u[i+1]);}
\DoxyCodeLine{00072     }
\DoxyCodeLine{00073     \}}
\DoxyCodeLine{00074 }
\DoxyCodeLine{00075 \}}
\DoxyCodeLine{00076     }
\DoxyCodeLine{00077 }
\DoxyCodeLine{\Hypertarget{LUSolver_8cc_source_l00078}\mbox{\hyperlink{classLUTridiagonalSolver_aceddcd98aa6ec424d5e537f07d87576f}{00078}} \textcolor{keyword}{template} <\textcolor{keyword}{class} V, \textcolor{keyword}{class} I> \mbox{\hyperlink{classLUTridiagonalSolver_aceddcd98aa6ec424d5e537f07d87576f}{LUTridiagonalSolver<V,I>::LUTridiagonalSolver}}()}
\DoxyCodeLine{00079 \{}
\DoxyCodeLine{00080     }
\DoxyCodeLine{00081     a = \mbox{\hyperlink{classVector}{Vector<V,I>}} (1);}
\DoxyCodeLine{00082     \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}} = \mbox{\hyperlink{classVector}{Vector<V,I>}} (1);}
\DoxyCodeLine{00083     c = \mbox{\hyperlink{classVector}{Vector<V,I>}} (1);}
\DoxyCodeLine{00084     \mbox{\hyperlink{namespaceNSEuropeanOption_adf476278b7e6a6960d82dc00e93ef723}{r}} = \mbox{\hyperlink{classVector}{Vector<V,I>}} (1);}
\DoxyCodeLine{00085 }
\DoxyCodeLine{00086     Size = 1;}
\DoxyCodeLine{00087 \}}
\DoxyCodeLine{00088 }
\DoxyCodeLine{\Hypertarget{LUSolver_8cc_source_l00089}\mbox{\hyperlink{classLUTridiagonalSolver_a6819482146633c32327a2a6b9803e115}{00089}} \textcolor{keyword}{template} <\textcolor{keyword}{class} V, \textcolor{keyword}{class} I> \mbox{\hyperlink{classLUTridiagonalSolver_aceddcd98aa6ec424d5e537f07d87576f}{LUTridiagonalSolver<V,I>::LUTridiagonalSolver}}(\mbox{\hyperlink{classVector}{Vector<V,I>}}\& lower, \mbox{\hyperlink{classVector}{Vector<V,I>}}\& diagonal, \mbox{\hyperlink{classVector}{Vector<V,I>}}\& upper, \mbox{\hyperlink{classVector}{Vector<V,I>}}\& RHS)}
\DoxyCodeLine{00090 \{}
\DoxyCodeLine{00091 }
\DoxyCodeLine{00092     a = lower;}
\DoxyCodeLine{00093     \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}} = diagonal;}
\DoxyCodeLine{00094     c = upper;}
\DoxyCodeLine{00095     \mbox{\hyperlink{namespaceNSEuropeanOption_adf476278b7e6a6960d82dc00e93ef723}{r}} = RHS;}
\DoxyCodeLine{00096 }
\DoxyCodeLine{00097     Size = diagonal.\mbox{\hyperlink{classArray_a69342621906b355e8244466f9eeece71}{Size}}();}
\DoxyCodeLine{00098 }
\DoxyCodeLine{00099 \}}
\DoxyCodeLine{00100 }
\DoxyCodeLine{\Hypertarget{LUSolver_8cc_source_l00101}\mbox{\hyperlink{classLUTridiagonalSolver_abc85aa731a341b6c8fbc5bc77c77e8a3}{00101}} \textcolor{keyword}{template} <\textcolor{keyword}{class} V, \textcolor{keyword}{class} I> \mbox{\hyperlink{classLUTridiagonalSolver_aceddcd98aa6ec424d5e537f07d87576f}{LUTridiagonalSolver<V,I>::LUTridiagonalSolver}}(\textcolor{keyword}{const} \mbox{\hyperlink{classLUTridiagonalSolver}{LUTridiagonalSolver<V,I>}}\& source) }
\DoxyCodeLine{00102 \{}
\DoxyCodeLine{00103 }
\DoxyCodeLine{00104     a = source.a;}
\DoxyCodeLine{00105     \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}} = source.b;}
\DoxyCodeLine{00106     c = source.c;}
\DoxyCodeLine{00107     \mbox{\hyperlink{namespaceNSEuropeanOption_adf476278b7e6a6960d82dc00e93ef723}{r}} = source.r;}
\DoxyCodeLine{00108 }
\DoxyCodeLine{00109     Size = source.Size;}
\DoxyCodeLine{00110 }
\DoxyCodeLine{00111 \}}
\DoxyCodeLine{00112 }
\DoxyCodeLine{00113     }
\DoxyCodeLine{\Hypertarget{LUSolver_8cc_source_l00114}\mbox{\hyperlink{classLUTridiagonalSolver_a1644f4512162dc3c91f5598dc3b5caad}{00114}} \textcolor{keyword}{template} <\textcolor{keyword}{class} V, \textcolor{keyword}{class} I> \mbox{\hyperlink{classLUTridiagonalSolver_a1644f4512162dc3c91f5598dc3b5caad}{LUTridiagonalSolver<V,I>::~LUTridiagonalSolver}}()}
\DoxyCodeLine{00115 \{}
\DoxyCodeLine{00116 }
\DoxyCodeLine{00117 \}}
\DoxyCodeLine{00118     }
\DoxyCodeLine{00119 \textcolor{comment}{// Assignment operator }}
\DoxyCodeLine{\Hypertarget{LUSolver_8cc_source_l00120}\mbox{\hyperlink{classLUTridiagonalSolver_a2cdb62889b9371224819f07a5daf5df3}{00120}} \textcolor{keyword}{template} <\textcolor{keyword}{class} V, \textcolor{keyword}{class} I> \mbox{\hyperlink{classLUTridiagonalSolver}{LUTridiagonalSolver<V,I>}}\& \mbox{\hyperlink{classLUTridiagonalSolver_a2cdb62889b9371224819f07a5daf5df3}{LUTridiagonalSolver<V,I>::operator = }}(\textcolor{keyword}{const} \mbox{\hyperlink{classLUTridiagonalSolver}{LUTridiagonalSolver<V,I>}}\& source)}
\DoxyCodeLine{00121 \{}
\DoxyCodeLine{00122     }
\DoxyCodeLine{00123     \textcolor{keywordflow}{if} (\textcolor{keyword}{this} == \&source)}
\DoxyCodeLine{00124         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{00125 }
\DoxyCodeLine{00126     a = source.a;}
\DoxyCodeLine{00127     \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}} = source.b;}
\DoxyCodeLine{00128     c = source.c;}
\DoxyCodeLine{00129     \mbox{\hyperlink{namespaceNSEuropeanOption_adf476278b7e6a6960d82dc00e93ef723}{r}} = source.r;}
\DoxyCodeLine{00130 }
\DoxyCodeLine{00131     Size = source.Size;}
\DoxyCodeLine{00132 \}}
\DoxyCodeLine{00133 }
\DoxyCodeLine{00134 }
\DoxyCodeLine{00135 \textcolor{comment}{// Calculate the solution to Au = r}}
\DoxyCodeLine{\Hypertarget{LUSolver_8cc_source_l00136}\mbox{\hyperlink{classLUTridiagonalSolver_aaa85d72ad1cd651291fee595db3fe1d8}{00136}} \textcolor{keyword}{template} <\textcolor{keyword}{class} V, \textcolor{keyword}{class} I> \mbox{\hyperlink{classVector}{Vector<V,I>}} \mbox{\hyperlink{classLUTridiagonalSolver_aaa85d72ad1cd651291fee595db3fe1d8}{LUTridiagonalSolver<V,I>::solve}}()}
\DoxyCodeLine{00137 \{}
\DoxyCodeLine{00138     \textcolor{comment}{//cout << "Solving " << endl;}}
\DoxyCodeLine{00139 }
\DoxyCodeLine{00140     calculateBetaGamma();       \textcolor{comment}{// Calculate beta and gamma}}
\DoxyCodeLine{00141     calculateZU();              \textcolor{comment}{// Calculate z and u}}
\DoxyCodeLine{00142 }
\DoxyCodeLine{00143     \textcolor{keywordflow}{return} u;}
\DoxyCodeLine{00144     }
\DoxyCodeLine{00145 \}}
\DoxyCodeLine{00146 }
\DoxyCodeLine{\Hypertarget{LUSolver_8cc_source_l00147}\mbox{\hyperlink{classLUTridiagonalSolver_a4cb24bdf98332a3fd46da775166ced08}{00147}} \textcolor{keyword}{template} <\textcolor{keyword}{class} V, \textcolor{keyword}{class} I> \textcolor{keywordtype}{bool} \mbox{\hyperlink{classLUTridiagonalSolver_a4cb24bdf98332a3fd46da775166ced08}{LUTridiagonalSolver<V,I>::diagonallyDominant}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{00148 \textcolor{keyword}{}\{}
\DoxyCodeLine{00149     \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}}[1]) < std::fabs(c[1]))}
\DoxyCodeLine{00150         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00151 }
\DoxyCodeLine{00152     \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}}[Size]) < std::fabs(a[Size]))}
\DoxyCodeLine{00153         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00154 }
\DoxyCodeLine{00155     \textcolor{keywordflow}{for} (I j = 2; j <= Size-\/1; j++)}
\DoxyCodeLine{00156     \{}
\DoxyCodeLine{00157         \textcolor{keywordflow}{if} (std::fabs(\mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}}[j]) < std::fabs(a[j]) + std::fabs(c[j]) )}
\DoxyCodeLine{00158             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00159     \}}
\DoxyCodeLine{00160 }
\DoxyCodeLine{00161     }
\DoxyCodeLine{00162     \textcolor{keywordflow}{return} \textcolor{keyword}{true}; }
\DoxyCodeLine{00163 \}}
\DoxyCodeLine{00164 }
\DoxyCodeLine{00165 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
