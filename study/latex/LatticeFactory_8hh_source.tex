\hypertarget{LatticeFactory_8hh_source}{}\doxysection{Lattice\+Factory.\+hh}
\label{LatticeFactory_8hh_source}\index{include/duffy/LatticeFactory.hh@{include/duffy/LatticeFactory.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{// LatticeFactory.hpp}}
\DoxyCodeLine{00002 \textcolor{comment}{//}}
\DoxyCodeLine{00003 \textcolor{comment}{// Abstract Factory for creating binomial lattice. Note}}
\DoxyCodeLine{00004 \textcolor{comment}{// that there is a built-\/in Template Method pattern built}}
\DoxyCodeLine{00005 \textcolor{comment}{// in here.}}
\DoxyCodeLine{00006 \textcolor{comment}{//}}
\DoxyCodeLine{00007 \textcolor{comment}{// (C) Datasim Education BV 2005}}
\DoxyCodeLine{00008 \textcolor{comment}{//}}
\DoxyCodeLine{00009 }
\DoxyCodeLine{00010 \textcolor{preprocessor}{\#ifndef LatticeFactory\_hpp}}
\DoxyCodeLine{00011 \textcolor{preprocessor}{\#define LatticeFactory\_hpp}}
\DoxyCodeLine{00012 }
\DoxyCodeLine{00013 \textcolor{preprocessor}{\#include "\mbox{\hyperlink{Lattice_8hh}{Lattice.hh}}"}}
\DoxyCodeLine{00014 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{00015 }
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00016}\mbox{\hyperlink{classLatticeFactory}{00016}} \textcolor{keyword}{class }\mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}}
\DoxyCodeLine{00017 \{}
\DoxyCodeLine{00018 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00019}\mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{00019}}         \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}};}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00020}\mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{00020}}         \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{d}};}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00021}\mbox{\hyperlink{classLatticeFactory_a4552002d494824b82c182b6c3b145a8a}{00021}}         \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a4552002d494824b82c182b6c3b145a8a}{p}};}
\DoxyCodeLine{00022 }
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00023}\mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{00023}}         \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}};}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00024}\mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{00024}}         \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}};}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00025}\mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{00025}}         \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}};}
\DoxyCodeLine{00026     }
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00027}\mbox{\hyperlink{classLatticeFactory_a0ec2e0cbbdc1928d5f75bea6f6593f14}{00027}}         \textcolor{keyword}{enum} \mbox{\hyperlink{classLatticeFactory_a0ec2e0cbbdc1928d5f75bea6f6593f14}{Type}} \{\mbox{\hyperlink{classLatticeFactory_a0ec2e0cbbdc1928d5f75bea6f6593f14aa3552a46dd1f16a919583e05abc557da}{Additive}}, \mbox{\hyperlink{classLatticeFactory_a0ec2e0cbbdc1928d5f75bea6f6593f14ae704b7a93c7e6a0b3b09f12c70090b04}{Multiplicative}}\};}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00028}\mbox{\hyperlink{classLatticeFactory_a709bb1b3ae7c5976629720ac29a20087}{00028}}         \mbox{\hyperlink{classLatticeFactory_a0ec2e0cbbdc1928d5f75bea6f6593f14}{Type}} \mbox{\hyperlink{classLatticeFactory_a709bb1b3ae7c5976629720ac29a20087}{bType}};}
\DoxyCodeLine{00029 }
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00030}\mbox{\hyperlink{classLatticeFactory_aec3b521318bcaed891fd9d3acb269d7f}{00030}}         \mbox{\hyperlink{classLatticeFactory_aec3b521318bcaed891fd9d3acb269d7f}{LatticeFactory}}(\textcolor{keywordtype}{double} vol, \textcolor{keywordtype}{double} interest, \textcolor{keywordtype}{double} delta)}
\DoxyCodeLine{00031         \{}
\DoxyCodeLine{00032             \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} = vol;}
\DoxyCodeLine{00033             \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}} = interest;}
\DoxyCodeLine{00034             \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}} = delta;}
\DoxyCodeLine{00035             \mbox{\hyperlink{classLatticeFactory_a709bb1b3ae7c5976629720ac29a20087}{bType}} = \mbox{\hyperlink{classLatticeFactory_a0ec2e0cbbdc1928d5f75bea6f6593f14ae704b7a93c7e6a0b3b09f12c70090b04}{Multiplicative}};}
\DoxyCodeLine{00036         \}}
\DoxyCodeLine{00037 }
\DoxyCodeLine{00038 }
\DoxyCodeLine{00039         \textcolor{comment}{// Useful function}}
\DoxyCodeLine{00040         \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classLatticeFactory_a4781748e08489056ee358df16207bec0}{updateLattice}}}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00041}\mbox{\hyperlink{classLatticeFactory_a4781748e08489056ee358df16207bec0}{00041}}             (\mbox{\hyperlink{classLattice}{Lattice<double, int, 2>}}\& source, \textcolor{keywordtype}{double} rootValue) \textcolor{keyword}{const}}
\DoxyCodeLine{00042         \{   \textcolor{comment}{// Find the depth of the lattice; this a Template Method Pattern}}
\DoxyCodeLine{00043 }
\DoxyCodeLine{00044             \textcolor{keywordtype}{int} si = source.\mbox{\hyperlink{classLattice_a07442df63222c6627f46efc4ae91acf9}{MinIndex}}();}
\DoxyCodeLine{00045             source[si][source[si].\mbox{\hyperlink{classLattice_a07442df63222c6627f46efc4ae91acf9}{MinIndex}}()] = rootValue;}
\DoxyCodeLine{00046 }
\DoxyCodeLine{00047             \textcolor{comment}{// Loop from the min index to the end index}}
\DoxyCodeLine{00048             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = source.MinIndex() + 1; j <= source.MaxIndex(); j++)}
\DoxyCodeLine{00049             \{}
\DoxyCodeLine{00050                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = source[j].MinIndex(); i < source[j].MaxIndex(); i++)}
\DoxyCodeLine{00051                 \{}
\DoxyCodeLine{00052                     source[j][i] = \mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{d}} * source[j-\/1][i];}
\DoxyCodeLine{00053                     source[j][i+1] = \mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}} * source[j-\/1][i];}
\DoxyCodeLine{00054                 \}}
\DoxyCodeLine{00055 }
\DoxyCodeLine{00056             \}}
\DoxyCodeLine{00057 }
\DoxyCodeLine{00058         \}}
\DoxyCodeLine{00059 \};}
\DoxyCodeLine{00060 }
\DoxyCodeLine{00061   }
\DoxyCodeLine{00062 }
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00063}\mbox{\hyperlink{classCRRFactory}{00063}} \textcolor{keyword}{class }\mbox{\hyperlink{classCRRFactory}{CRRFactory}}: \textcolor{keyword}{public} \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}}
\DoxyCodeLine{00064 \{}
\DoxyCodeLine{00065 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00066}\mbox{\hyperlink{classCRRFactory_a8f194a6375c6d8e885ea8ab8a9d1ce14}{00066}}     \mbox{\hyperlink{classCRRFactory_a8f194a6375c6d8e885ea8ab8a9d1ce14}{CRRFactory}}(\textcolor{keywordtype}{double} vol, \textcolor{keywordtype}{double} interest, \textcolor{keywordtype}{double} delta) }
\DoxyCodeLine{00067         : \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}(vol, interest, delta)}
\DoxyCodeLine{00068     \{}
\DoxyCodeLine{00069         \textcolor{keywordtype}{double} e = \mbox{\hyperlink{Complex_8cc_aeb56775d93a065d4bd643a5ed679db8c}{std::exp}}((\mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}})*\mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}});}
\DoxyCodeLine{00070         \textcolor{keywordtype}{double} sr = std::sqrt(\mbox{\hyperlink{Complex_8cc_aeb56775d93a065d4bd643a5ed679db8c}{std::exp}}(vol*vol*\mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}}) -\/ 1.0);}
\DoxyCodeLine{00071 }
\DoxyCodeLine{00072 }
\DoxyCodeLine{00073         \mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}} = e * (1.0 + sr);}
\DoxyCodeLine{00074         \mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{d}} = e * (1.0 -\/ sr);}
\DoxyCodeLine{00075 }
\DoxyCodeLine{00076         \textcolor{keywordtype}{double} discounting = \mbox{\hyperlink{Complex_8cc_aeb56775d93a065d4bd643a5ed679db8c}{std::exp}}(-\/ \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}}*\mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}});}
\DoxyCodeLine{00077     }
\DoxyCodeLine{00078         \mbox{\hyperlink{classLatticeFactory_a4552002d494824b82c182b6c3b145a8a}{p}} = 0.5;}
\DoxyCodeLine{00079     \}}
\DoxyCodeLine{00080 }
\DoxyCodeLine{00081 \};}
\DoxyCodeLine{00082 }
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00083}\mbox{\hyperlink{classJRFactory}{00083}} \textcolor{keyword}{class }\mbox{\hyperlink{classJRFactory}{JRFactory}}: \textcolor{keyword}{public} \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}}
\DoxyCodeLine{00084 \{}
\DoxyCodeLine{00085 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00086}\mbox{\hyperlink{classJRFactory_afe5130ea21461c9b33ee7056e4ae1ca8}{00086}}     \mbox{\hyperlink{classJRFactory_afe5130ea21461c9b33ee7056e4ae1ca8}{JRFactory}}(\textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}}, \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}}, \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}}) }
\DoxyCodeLine{00087         : \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}(\mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}}, \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}}, \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}})}
\DoxyCodeLine{00088     \{}
\DoxyCodeLine{00089         \textcolor{keywordtype}{double} k2 = std::sqrt(\mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}});}
\DoxyCodeLine{00090         \mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}} = \mbox{\hyperlink{Complex_8cc_aeb56775d93a065d4bd643a5ed679db8c}{std::exp}}(\mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} * k2);}
\DoxyCodeLine{00091 }
\DoxyCodeLine{00092         \mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{d}} = 1.0/\mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}};}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094         \mbox{\hyperlink{classLatticeFactory_a4552002d494824b82c182b6c3b145a8a}{p}} = 0.5 + ((\mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}} -\/ 0.5 * \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} * \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}}) * k2 * 0.5) / \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}};}
\DoxyCodeLine{00095 }
\DoxyCodeLine{00096     \}}
\DoxyCodeLine{00097 \};}
\DoxyCodeLine{00098 }
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00099}\mbox{\hyperlink{classEQPFactory}{00099}} \textcolor{keyword}{class }\mbox{\hyperlink{classEQPFactory}{EQPFactory}}: \textcolor{keyword}{public} \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}}
\DoxyCodeLine{00100 \{}
\DoxyCodeLine{00101 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00102}\mbox{\hyperlink{classEQPFactory_af725d98da10178b6c86f5469336135f2}{00102}}     \mbox{\hyperlink{classEQPFactory_af725d98da10178b6c86f5469336135f2}{EQPFactory}}(\textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}}, \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}}, \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}}) }
\DoxyCodeLine{00103         : \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}(\mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}}, \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}}, \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}})}
\DoxyCodeLine{00104     \{}
\DoxyCodeLine{00105 }
\DoxyCodeLine{00106     \mbox{\hyperlink{classLatticeFactory_a709bb1b3ae7c5976629720ac29a20087}{bType}} = \mbox{\hyperlink{classLatticeFactory_a0ec2e0cbbdc1928d5f75bea6f6593f14aa3552a46dd1f16a919583e05abc557da}{Additive}};}
\DoxyCodeLine{00107 }
\DoxyCodeLine{00108     \textcolor{comment}{// Needed for additive method: page 19 Clewlow/Strickland formula 2.17 }}
\DoxyCodeLine{00109     \textcolor{comment}{// "v" is "nu" here, for "v" see  page 17 formula 2.14}}
\DoxyCodeLine{00110     \textcolor{keywordtype}{double} nu = \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}} -\/ 0.5 * \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} * \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}};}
\DoxyCodeLine{00111 }
\DoxyCodeLine{00112     \textcolor{keywordtype}{double} a = nu * \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}};}
\DoxyCodeLine{00113     \textcolor{keywordtype}{double} \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}} = 0.5 * std::sqrt( (4.0 * \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} * \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} * \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}}) -\/ (3.0 * nu * nu * \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}} * \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}}) );}
\DoxyCodeLine{00114 }
\DoxyCodeLine{00115     \textcolor{comment}{// EQP parameters: page 19 formula 2.17}}
\DoxyCodeLine{00116     \mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}} = 0.5 * a + \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}};                                                      }
\DoxyCodeLine{00117     \mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{d}} = 1.5 * a -\/ \mbox{\hyperlink{namespaceNSEuropeanOption_a6b26f4d79c6b43133be664e2eb229fff}{b}};}
\DoxyCodeLine{00118 }
\DoxyCodeLine{00119     \mbox{\hyperlink{classLatticeFactory_a4552002d494824b82c182b6c3b145a8a}{p}} = 0.5;}
\DoxyCodeLine{00120     }
\DoxyCodeLine{00121     \textcolor{comment}{// pd = 0.5 = (1-\/p)}}
\DoxyCodeLine{00122 }
\DoxyCodeLine{00123     \}}
\DoxyCodeLine{00124 }
\DoxyCodeLine{00125 }
\DoxyCodeLine{00126 \};}
\DoxyCodeLine{00127 }
\DoxyCodeLine{00128 }
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00129}\mbox{\hyperlink{classTRGFactory}{00129}} \textcolor{keyword}{class }\mbox{\hyperlink{classTRGFactory}{TRGFactory}}: \textcolor{keyword}{public} \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}}
\DoxyCodeLine{00130 \{}
\DoxyCodeLine{00131 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00132}\mbox{\hyperlink{classTRGFactory_a01c4def905794c039a8e60b3e5212ae2}{00132}}     \mbox{\hyperlink{classTRGFactory_a01c4def905794c039a8e60b3e5212ae2}{TRGFactory}}(\textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}}, \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}}, \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}}) }
\DoxyCodeLine{00133         : \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}(\mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}}, \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}}, \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}})}
\DoxyCodeLine{00134     \{}
\DoxyCodeLine{00135     }
\DoxyCodeLine{00136     \mbox{\hyperlink{classLatticeFactory_a709bb1b3ae7c5976629720ac29a20087}{bType}} = \mbox{\hyperlink{classLatticeFactory_a0ec2e0cbbdc1928d5f75bea6f6593f14aa3552a46dd1f16a919583e05abc557da}{Additive}};}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138     \textcolor{comment}{// Needed for additive method: page 19 formula 2.19 }}
\DoxyCodeLine{00139     \textcolor{comment}{// "v" is "nu" here, for "v" see  page 17 formula 2.14}}
\DoxyCodeLine{00140     \textcolor{keywordtype}{double} nu = \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}} -\/ 0.5 * \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} * \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}};}
\DoxyCodeLine{00141 }
\DoxyCodeLine{00142     \textcolor{keywordtype}{double} nudt = nu * \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}};}
\DoxyCodeLine{00143 }
\DoxyCodeLine{00144     \textcolor{comment}{// TRG parameters: page 19 formula 2.19}}
\DoxyCodeLine{00145     \mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}} = std::sqrt( \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} * \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} * \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}} + nudt * nudt );}
\DoxyCodeLine{00146     \mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{d}} = -\/ \mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}};}
\DoxyCodeLine{00147 }
\DoxyCodeLine{00148     \mbox{\hyperlink{classLatticeFactory_a4552002d494824b82c182b6c3b145a8a}{p}} = 0.5 * (1.0 + (nudt/\mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}}) );}
\DoxyCodeLine{00149 }
\DoxyCodeLine{00150     \}}
\DoxyCodeLine{00151 }
\DoxyCodeLine{00152 }
\DoxyCodeLine{00153 \};}
\DoxyCodeLine{00154 }
\DoxyCodeLine{00155 }
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00156}\mbox{\hyperlink{classModCRRFactory}{00156}} \textcolor{keyword}{class }\mbox{\hyperlink{classModCRRFactory}{ModCRRFactory}}: \textcolor{keyword}{public} \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}}
\DoxyCodeLine{00157 \{}
\DoxyCodeLine{00158 \textcolor{keyword}{public}:}
\DoxyCodeLine{\Hypertarget{LatticeFactory_8hh_source_l00159}\mbox{\hyperlink{classModCRRFactory_a696757239e4e08ad9d0a14f6e5c22fd7}{00159}}     \mbox{\hyperlink{classModCRRFactory_a696757239e4e08ad9d0a14f6e5c22fd7}{ModCRRFactory}}(\textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}}, \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}}, \textcolor{keywordtype}{double} \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}}, \textcolor{keywordtype}{double} S, \textcolor{keywordtype}{double} \mbox{\hyperlink{namespacePayoffNamespace_ab501f4bdb2c74995b98b666056c671fb}{K}}, \textcolor{keywordtype}{int} \mbox{\hyperlink{TestImpliedVolatility_8cc_a6cbb82a21dec4c4f36c3f78340be64de}{N}}) }
\DoxyCodeLine{00160         : \mbox{\hyperlink{classLatticeFactory}{LatticeFactory}}(\mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}}, \mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}}, \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}})}
\DoxyCodeLine{00161     \{}
\DoxyCodeLine{00162         }
\DoxyCodeLine{00163         \textcolor{keywordtype}{double} KN = std::log(\mbox{\hyperlink{namespacePayoffNamespace_ab501f4bdb2c74995b98b666056c671fb}{K}}/S) / double (\mbox{\hyperlink{TestImpliedVolatility_8cc_a6cbb82a21dec4c4f36c3f78340be64de}{N}});}
\DoxyCodeLine{00164         \textcolor{keywordtype}{double} VN = \mbox{\hyperlink{classLatticeFactory_a60d65acca1c40e10105e0b45532a2a30}{s}} * std::sqrt(\mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}});}
\DoxyCodeLine{00165 }
\DoxyCodeLine{00166         \mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}} = \mbox{\hyperlink{Complex_8cc_aeb56775d93a065d4bd643a5ed679db8c}{std::exp}}(KN + VN);}
\DoxyCodeLine{00167         \mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{d}} = \mbox{\hyperlink{Complex_8cc_aeb56775d93a065d4bd643a5ed679db8c}{std::exp}}(KN -\/ VN);}
\DoxyCodeLine{00168 }
\DoxyCodeLine{00169         \mbox{\hyperlink{classLatticeFactory_a4552002d494824b82c182b6c3b145a8a}{p}} = (\mbox{\hyperlink{Complex_8cc_aeb56775d93a065d4bd643a5ed679db8c}{std::exp}}(\mbox{\hyperlink{classLatticeFactory_ae5b47a8cf4ef7e20c0297615837bb592}{r}} * \mbox{\hyperlink{classLatticeFactory_a418f424cf85a82bf52cd7cfcebc677d3}{k}}) -\/ \mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{d}}) / (\mbox{\hyperlink{classLatticeFactory_a7183c1217f75a45b5951dbcc1115782b}{u}} -\/ \mbox{\hyperlink{classLatticeFactory_a99e4419112358eac102e48d31090a79b}{d}});}
\DoxyCodeLine{00170     \}}
\DoxyCodeLine{00171 }
\DoxyCodeLine{00172 \};}
\DoxyCodeLine{00173 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
