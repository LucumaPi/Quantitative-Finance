\hypertarget{EEulerIBVPSolver_8cc_source}{}\doxysection{E\+Euler\+I\+B\+V\+P\+Solver.\+cc}
\label{EEulerIBVPSolver_8cc_source}\index{src/EEulerIBVPSolver.cc@{src/EEulerIBVPSolver.cc}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{comment}{// EEulerIbvpSolver.cpp}}
\DoxyCodeLine{00002 \textcolor{comment}{//}}
\DoxyCodeLine{00003 \textcolor{comment}{// Solvers for initial boundary value problems. We }}
\DoxyCodeLine{00004 \textcolor{comment}{// use an abstract base class; derived class implement}}
\DoxyCodeLine{00005 \textcolor{comment}{// specific behaviour.}}
\DoxyCodeLine{00006 \textcolor{comment}{//}}
\DoxyCodeLine{00007 \textcolor{comment}{// 2005-\/9-\/36 DD kick-\/off}}
\DoxyCodeLine{00008 \textcolor{comment}{// 2005-\/10-\/1 DD next rev.}}
\DoxyCodeLine{00009 \textcolor{comment}{// 2005-\/10-\/11 DD last revision?}}
\DoxyCodeLine{00010 \textcolor{comment}{// 2005-\/11-\/30 DD New cpp file}}
\DoxyCodeLine{00011 \textcolor{comment}{// 2005-\/12-\/5 DD h\string^-\/2 -\/-\/> DJJ}}
\DoxyCodeLine{00012 \textcolor{comment}{//}}
\DoxyCodeLine{00013 \textcolor{comment}{// (C) Datasim Component Technology BV 2003-\/2006}}
\DoxyCodeLine{00014 \textcolor{comment}{//}}
\DoxyCodeLine{00015 }
\DoxyCodeLine{00016 \textcolor{preprocessor}{\#ifndef EEulerIBVPSOLVER\_CPP}}
\DoxyCodeLine{\Hypertarget{EEulerIBVPSolver_8cc_source_l00017}\mbox{\hyperlink{EEulerIBVPSolver_8cc_aec061d69965a969738f538f89b3337d6}{00017}} \textcolor{preprocessor}{\#define EEulerIBVPSOLVER\_CPP}}
\DoxyCodeLine{00018 }
\DoxyCodeLine{00019 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{EEulerIBVPSolver_8hh}{duffy/EEulerIBVPSolver.hh}}>}}
\DoxyCodeLine{00020 }
\DoxyCodeLine{\Hypertarget{EEulerIBVPSolver_8cc_source_l00021}\mbox{\hyperlink{classExplicitEulerIBVP_a2c38c5ff117433887ded82a87f99422b}{00021}} \mbox{\hyperlink{classExplicitEulerIBVP_a2c38c5ff117433887ded82a87f99422b}{ExplicitEulerIBVP::ExplicitEulerIBVP}}(): \mbox{\hyperlink{classIBVPFDM}{IBVPFDM}}()}
\DoxyCodeLine{00022 \{}
\DoxyCodeLine{00023 \}}
\DoxyCodeLine{00024 }
\DoxyCodeLine{\Hypertarget{EEulerIBVPSolver_8cc_source_l00025}\mbox{\hyperlink{classExplicitEulerIBVP_accba0abdf48e79de3549a528dbaf2b0f}{00025}} \mbox{\hyperlink{classExplicitEulerIBVP_a2c38c5ff117433887ded82a87f99422b}{ExplicitEulerIBVP::ExplicitEulerIBVP}}(\mbox{\hyperlink{classIBVP}{IBVP}}\& source, \textcolor{keywordtype}{long} NSteps, \textcolor{keywordtype}{long} JSteps)}
\DoxyCodeLine{00026         : \mbox{\hyperlink{classIBVPFDM}{IBVPFDM}}(source, NSteps, JSteps)}
\DoxyCodeLine{00027 \{}
\DoxyCodeLine{00028 \}}
\DoxyCodeLine{00029 }
\DoxyCodeLine{00030 \textcolor{comment}{// Hook function for Template Method pattern }}
\DoxyCodeLine{\Hypertarget{EEulerIBVPSolver_8cc_source_l00031}\mbox{\hyperlink{classExplicitEulerIBVP_a01074c892ad9625daa7885cba20afccc}{00031}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classExplicitEulerIBVP_a01074c892ad9625daa7885cba20afccc}{ExplicitEulerIBVP::calculateBC}}()}
\DoxyCodeLine{00032 \{ \textcolor{comment}{// Tells how to calculate sol. at n+1}}
\DoxyCodeLine{00033     \mbox{\hyperlink{classIBVPFDM_acdb610da30891ef45dba3af0ef080a2c}{vecNew}}[\mbox{\hyperlink{classIBVPFDM_acdb610da30891ef45dba3af0ef080a2c}{vecNew}}.\mbox{\hyperlink{classArray_acffe058a1dd631b05fb71a83e27b445a}{MinIndex}}()] = \mbox{\hyperlink{classIBVPFDM_ac23f7379cd6d342fc9e640171ec2a43b}{ibvp}}-\/>\mbox{\hyperlink{classIBVP_a06a4841866f3ec0f7f62f67a7e800930}{BCL}}(\mbox{\hyperlink{classIBVPFDM_adcbf3a3c0024261777514d461f5fa28c}{tprev}});}
\DoxyCodeLine{00034     \mbox{\hyperlink{classIBVPFDM_acdb610da30891ef45dba3af0ef080a2c}{vecNew}}[\mbox{\hyperlink{classIBVPFDM_acdb610da30891ef45dba3af0ef080a2c}{vecNew}}.\mbox{\hyperlink{classArray_a8ce7791cd1ec7ba63ec71772a7144965}{MaxIndex}}()] = \mbox{\hyperlink{classIBVPFDM_ac23f7379cd6d342fc9e640171ec2a43b}{ibvp}}-\/>\mbox{\hyperlink{classIBVP_afd987bb4e41ff033ce8d0705818f4cef}{BCR}}(\mbox{\hyperlink{classIBVPFDM_adcbf3a3c0024261777514d461f5fa28c}{tprev}});}
\DoxyCodeLine{00035 \}}
\DoxyCodeLine{00036 }
\DoxyCodeLine{00037 }
\DoxyCodeLine{\Hypertarget{EEulerIBVPSolver_8cc_source_l00038}\mbox{\hyperlink{classExplicitEulerIBVP_af7590356fa10c6c1a218634e2b0b52b4}{00038}} \textcolor{keywordtype}{void} \mbox{\hyperlink{classExplicitEulerIBVP_af7590356fa10c6c1a218634e2b0b52b4}{ExplicitEulerIBVP::calculate}}()}
\DoxyCodeLine{00039 \{ \textcolor{comment}{// Tells how to calculate sol. at n+1}}
\DoxyCodeLine{00040 \textcolor{comment}{// Explicit Euler schemes}}
\DoxyCodeLine{00041     std::cout << \textcolor{stringliteral}{"Explicit Euler calc\(\backslash\)n"};}
\DoxyCodeLine{00042 }
\DoxyCodeLine{00043     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{long} i = \mbox{\hyperlink{classIBVPFDM_acdb610da30891ef45dba3af0ef080a2c}{vecNew}}.\mbox{\hyperlink{classArray_acffe058a1dd631b05fb71a83e27b445a}{MinIndex}}()+1; i <= \mbox{\hyperlink{classIBVPFDM_acdb610da30891ef45dba3af0ef080a2c}{vecNew}}.\mbox{\hyperlink{classArray_a8ce7791cd1ec7ba63ec71772a7144965}{MaxIndex}}()-\/1; i++)}
\DoxyCodeLine{00044     \{}
\DoxyCodeLine{00045         tmp1 = \mbox{\hyperlink{classIBVPFDM_a823466697562114bcde6f8ae43eeb3f5}{k}}*(\mbox{\hyperlink{classIBVPFDM_ac23f7379cd6d342fc9e640171ec2a43b}{ibvp}}-\/>\mbox{\hyperlink{classIBVP_a59a82bedba3a8de65997ce6b64e612b5}{diffusion}}(\mbox{\hyperlink{classIBVPFDM_acde024de54dc2124db544dc6424365c7}{xarr}}[i], \mbox{\hyperlink{classIBVPFDM_adcbf3a3c0024261777514d461f5fa28c}{tprev}}));}
\DoxyCodeLine{00046         tmp2 = (\mbox{\hyperlink{classIBVPFDM_a823466697562114bcde6f8ae43eeb3f5}{k}}*\mbox{\hyperlink{classIBVPFDM_a20ec2ca54a8768c22ae5579021bcbc21}{h}}*0.5 * (\mbox{\hyperlink{classIBVPFDM_ac23f7379cd6d342fc9e640171ec2a43b}{ibvp}}-\/>\mbox{\hyperlink{classIBVP_a74f384836849c568e26b10bae327ace5}{convection}}(\mbox{\hyperlink{classIBVPFDM_acde024de54dc2124db544dc6424365c7}{xarr}}[i], \mbox{\hyperlink{classIBVPFDM_adcbf3a3c0024261777514d461f5fa28c}{tprev}})));}
\DoxyCodeLine{00047 }
\DoxyCodeLine{00048         \textcolor{comment}{// Coefficients of the U terms}}
\DoxyCodeLine{00049         alpha = tmp1 -\/ tmp2;}
\DoxyCodeLine{00050         beta = \mbox{\hyperlink{classIBVPFDM_a57f9b055edffae6936be2cb12e1746cb}{h2}} -\/ (2.0*tmp1) + (\mbox{\hyperlink{classIBVPFDM_a823466697562114bcde6f8ae43eeb3f5}{k}}*\mbox{\hyperlink{classIBVPFDM_a57f9b055edffae6936be2cb12e1746cb}{h2}}*(\mbox{\hyperlink{classIBVPFDM_ac23f7379cd6d342fc9e640171ec2a43b}{ibvp}}-\/>\mbox{\hyperlink{classIBVP_adf8e3d7993a300e7dd5c727d935ad8aa}{zeroterm}}(\mbox{\hyperlink{classIBVPFDM_acde024de54dc2124db544dc6424365c7}{xarr}}[i], \mbox{\hyperlink{classIBVPFDM_adcbf3a3c0024261777514d461f5fa28c}{tprev}})));}
\DoxyCodeLine{00051         gamma = tmp1 + tmp2;}
\DoxyCodeLine{00052 }
\DoxyCodeLine{00053         \mbox{\hyperlink{classIBVPFDM_acdb610da30891ef45dba3af0ef080a2c}{vecNew}}[i] = ( (alpha * \mbox{\hyperlink{classIBVPFDM_a9b5cf717e24fa77775650cbc2913785f}{vecOld}}[i-\/1])}
\DoxyCodeLine{00054                             + (beta * \mbox{\hyperlink{classIBVPFDM_a9b5cf717e24fa77775650cbc2913785f}{vecOld}}[i])}
\DoxyCodeLine{00055                             + (gamma * \mbox{\hyperlink{classIBVPFDM_a9b5cf717e24fa77775650cbc2913785f}{vecOld}}[i+1]) )/\mbox{\hyperlink{classIBVPFDM_a57f9b055edffae6936be2cb12e1746cb}{h2}} \textcolor{comment}{// * DJJ // djj = h\string^-\/2}}
\DoxyCodeLine{00056                             -\/ (\mbox{\hyperlink{classIBVPFDM_a823466697562114bcde6f8ae43eeb3f5}{k}}*(\mbox{\hyperlink{classIBVPFDM_ac23f7379cd6d342fc9e640171ec2a43b}{ibvp}} -\/> RHS(\mbox{\hyperlink{classIBVPFDM_acde024de54dc2124db544dc6424365c7}{xarr}}[i], \mbox{\hyperlink{classIBVPFDM_adcbf3a3c0024261777514d461f5fa28c}{tprev}})));}
\DoxyCodeLine{00057     \}}
\DoxyCodeLine{00058 \}}
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
